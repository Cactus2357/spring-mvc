<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>Book List</title>
</head>
<body class="d-flex flex-column h-100">
<main class="flex-shrink-0">
    <section layout:fragment="body" class="container py-5">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a class="text-decoration-none" th:href="@{/}">Home</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Book list</li>
                </ol>
            </nav>
        </div>
        <div class="container px-5 my-5">
            <div class="container">
                <div class="row">
                    <form class="col-6" role="form" method="post" th:action="@{/books}">
                        <input type="hidden" id="book-id" name="bookId" hidden="hidden">
                        <div class="mb-3">
                            <label for="book-title" class="form-label">Title*</label>
                            <input type="text" class="form-control form-control-sm" id="book-title" name="title"
                                   placeholder="Title">
                        </div>
                        <div class="mb-3">
                            <label for="book-quantity" class="form-label">Quantity*</label>
                            <input type="number" class="form-control form-control-sm" id="book-quantity" name="quantity"
                                   placeholder="Quantity...">
                        </div>
                        <div class="mb-3">
                            <label for="book-author" class="form-label">Author</label>
                            <input type="text" class="form-control form-control-sm" id="book-author" name="author"
                                   placeholder="Author (optional)">
                        </div>
                        <button type="submit" class="btn btn-sm btn-primary col-6">Submit</button>
                        <button type="reset" class="btn btn-sm btn-secondary col-3">Clear</button>
                    </form>
                </div>
            </div>
            <hr>
            <div class="container">
                <table id="book-table" class="table"></table>
                <script th:inline="javascript">
                    //<![CDATA[
                    $(function () {
                        "use strict";
                        const data = /*[[${bookList}]]*/ '[]';
                        $("#book-table").jqGrid({
                            data: data,
                            colModel: [
                                {name: "bookId", label: "ID", width: 50, key: true},
                                {name: "title", label: "Title", width: 200},
                                {name: "author", label: "Author", width: 150},
                                {name: "quantity", label: "Quantity", width: 100},
                                {
                                    label: "Option", width: 50, formatter: (cellValue, options, rowObject) => `<a href="books/${rowObject.bookId}/delete">Delete</a>`
                                }
                            ],
                            guiStyle: "bootstrap",
                            iconSet: "fontAwesome",
                            caption: "Book table",
                            pager: "#pager",
                            onSelectRow: function (rowId) {
                                const rowData = $(this).jqGrid('getRowData', rowId);
                                $("#book-id").val(rowData.bookId);
                                $("#book-title").val(rowData.title);
                                $("#book-author").val(rowData.author);
                                $("#book-quantity").val(rowData.quantity);
                            }
                        });
                    });
                    //]]>

                    $.ajax('')

                </script>
            </div>
        </div>
    </section>
</main>
</body>
</html>